<%# frozen_string_literal: true %>
<% self.class.send :include, HeartsHelper %>
<% if journal == @journals.first
     links = multiple_heart_links_with_counters @journals, User.current 
     # HACK to cache the link to ugly-named instance variable in controller
     controller.instance_variable_set(:@__journal_heart_link_cache, links)
   else
     links = controller.instance_variable_get(:@__journal_heart_link_cache)
   end %>
<% if defined?(links) && @journals.index(journal) %>
  <%= links[@journals.index(journal)] %>
<% else %>
  <%= heart_link_with_counter journal, User.current %><%# fallback %>
<% end %>
